var v=Object.defineProperty;var L=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var w=(p,e,i)=>e in p?v(p,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):p[e]=i,y=(p,e)=>{for(var i in e||(e={}))S.call(e,i)&&w(p,i,e[i]);if(L)for(var i of L(e))T.call(e,i)&&w(p,i,e[i]);return p};var b=(p,e,i)=>(w(p,typeof e!="symbol"?e+"":e,i),i);import{c as f,g as d,d as g,t as E,e as O}from"./index-Cjfam9dp.js";import{C as k}from"./index-BR6LcWRs.js";class I{constructor(e){b(this,"computeStar2d",(e,i,n)=>{let t=Math.PI/e,a=2*e,l=new Array(a);for(let s=0;s<a;s++){let c=s%2===0?i:n;l[s]=new Cesium.Cartesian2(Math.cos(s*t)*c,Math.sin(s*t)*c)}return l});this._viewer=e,this._drawLayer=new Cesium.CustomDataSource("drawLayer"),e&&e.dataSources.add(this._drawLayer)}get drawLayer(){return this._drawLayer}drawPointGraphics({style:e={image:"src/assets/image/location4.png",width:35,height:50,clampToGround:!0,scale:1,pixelOffset:new Cesium.Cartesian2(0,-20)},callback:i=()=>{}}){let n=new Cesium.Entity,t,a=[],l,s=new Cesium.ScreenSpaceEventHandler(this._viewer.scene.canvas);s.setInputAction(c=>{const r=this._viewer.scene.camera.pickEllipsoid(c.position,this._viewer.scene.globe.ellipsoid);r&&r.x&&(t=r,a.push(r))},Cesium.ScreenSpaceEventType.LEFT_CLICK),s.setInputAction(c=>{s.destroy(),s=null,typeof i=="function"&&i(f(a),l)},Cesium.ScreenSpaceEventType.RIGHT_CLICK),n.billboard=e,n.position=new Cesium.CallbackProperty(function(){return t},!1),l=this._drawLayer.entities.add(n)}drawLineGraphics(e){if(e=e||{},this._viewer&&e){let i=function(c){const r=new Cesium.Entity;r.position=c,r.point={pixelSize:10,outlineColor:Cesium.Color.BLUE,outlineWidth:5},r.label={text:(g(f(n))/1e3).toFixed(4)+"公里",show:!0,showBackground:!0,font:"14px monospace",backgroundColor:Cesium.Color.YELLOW.withAlpha(.8),fillColor:Cesium.Color.BLACK,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(-20,-20)},a._drawLayer.entities.add(r)},n=[],t=new Cesium.Entity,a=this,l,s=new Cesium.ScreenSpaceEventHandler(this._viewer.scene.canvas);s.setInputAction(function(c){const r=d(a._viewer,c.position);r&&r.x&&(n.length==0&&n.push(r.clone()),e.measure&&i(r),n.length==2&&e.type==="straightLine"&&(s.destroy(),s=null,typeof e.callback=="function"&&e.callback(f(n),l)),n.push(r))},Cesium.ScreenSpaceEventType.LEFT_CLICK),s.setInputAction(function(c){const r=d(a._viewer,c.endPosition);n.length>=2&&r&&r.x&&(n.pop(),n.push(r))},Cesium.ScreenSpaceEventType.MOUSE_MOVE),s.setInputAction(function(c){s.destroy(),s=null;const r=d(a._viewer,c.position);e.measure&&i(r),typeof e.callback=="function"&&e.callback(f(n),l)},Cesium.ScreenSpaceEventType.RIGHT_CLICK),t.polyline={width:e.width||5,material:e.material||Cesium.Color.BLUE.withAlpha(.8),clampToGround:e.clampToGround||!1,clampToS3M:e.clampToS3M||!1},t.polyline.positions=new Cesium.CallbackProperty(function(){return n},!1),l=this._drawLayer.entities.add(t)}}drawPolygonGraphics(e){if(e=e||{},e.style=e.style||{width:3,material:Cesium.Color.BLUE.withAlpha(.8),clampToGround:!0},this._viewer&&e){let i=function(){l.polyline=e.style,l.polyline.positions=new Cesium.CallbackProperty(function(){return t},!1),l.polygon={hierarchy:new Cesium.CallbackProperty(function(){return a},!1),material:Cesium.Color.WHITE.withAlpha(.1),clampToGround:e.clampToGround||!1},l.clampToS3M=!0,c=s._drawLayer.entities.add(l)},n=function(h){const o=new Cesium.Entity;o.position=h,o.point={pixelSize:10,outlineColor:Cesium.Color.BLUE,outlineWidth:5},o.label={text:(O(f(t))/1e6).toFixed(4)+"平方公里",show:!0,showBackground:!0,font:"14px monospace",backgroundColor:Cesium.Color.YELLOW.withAlpha(.8),fillColor:Cesium.Color.BLACK,horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(-20,-20)},s._drawLayer.entities.add(o)},t=[],a=new Cesium.PolygonHierarchy,l=new Cesium.Entity,s=this,c=null,r=new Cesium.ScreenSpaceEventHandler(this._viewer.scene.canvas);r.setInputAction(function(h){const o=d(s._viewer,h.position);o&&o.x&&(t.length==0&&(a.positions.push(o.clone()),t.push(o.clone())),t.push(o.clone()),a.positions.push(o.clone()),c||i())},Cesium.ScreenSpaceEventType.LEFT_CLICK),r.setInputAction(function(h){const o=d(s._viewer,h.endPosition);t.length>=2&&o&&o.x&&(t.pop(),t.push(o),a.positions.pop(),a.positions.push(o))},Cesium.ScreenSpaceEventType.MOUSE_MOVE),r.setInputAction(function(h){r.destroy(),t.push(t[0]),e.height&&(l.polygon.extrudedHeight=e.height,l.polygon.material=Cesium.Color.BLUE.withAlpha(.5)),e.measure&&n(t[0]),typeof e.callback=="function"&&e.callback(f(t),c)},Cesium.ScreenSpaceEventType.RIGHT_CLICK)}}drawRectangleGraphics(e){if(e=e||{},e.style=e.style||{width:3,material:Cesium.Color.BLUE.withAlpha(.5),clampToGround:!0},this._viewer&&e){let i=[],n=new Cesium.Entity,t=new Cesium.Rectangle,a=this,l,s=new Cesium.ScreenSpaceEventHandler(this._viewer.scene.canvas);s.setInputAction(function(c){const r=d(a._viewer,c.position);r&&r.x&&(i.length==0?i.push(r.clone()):(s.destroy(),i.push(r.clone()),t=Cesium.Rectangle.fromCartesianArray([...i,r],Cesium.Ellipsoid.WGS84),typeof e.callback=="function"&&e.callback(f(i),l)))},Cesium.ScreenSpaceEventType.LEFT_CLICK),s.setInputAction(function(c){const r=d(a._viewer,c.endPosition);r&&(t=Cesium.Rectangle.fromCartesianArray([...i,r],Cesium.Ellipsoid.WGS84))},Cesium.ScreenSpaceEventType.MOUSE_MOVE),n.rectangle=e.style,e.height&&(n.rectangle.extrudedHeight=e.height),n.rectangle.coordinates=new Cesium.CallbackProperty(function(){return t},!1),l=this._drawLayer.entities.add(n)}}drawCircleGraphics(e){if(e=e||{},e.style=e.style||{width:3,material:Cesium.Color.BLUE.withAlpha(.5),clampToGround:!0},this._viewer&&e){let i=function(h,o){const C=Cesium.Cartographic.fromCartesian(h),u=Cesium.Cartographic.fromCartesian(o),m=new Cesium.EllipsoidGeodesic;m.setEndPoints(C,u);const _=m.surfaceDistance;c=Math.sqrt(Math.pow(_,2)+Math.pow(u.height-C.height,2))},n=function(){a.ellipse=e.style,a.ellipse.semiMajorAxis=new Cesium.CallbackProperty(function(){return c},!1),a.ellipse.semiMinorAxis=new Cesium.CallbackProperty(function(){return c},!1),a.position=new Cesium.CallbackProperty(function(){return t},!1),a.point={pixelSize:5,outlineColor:Cesium.Color.RED,outlineWidth:3},e.height&&(a.ellipse.extrudedHeight=e.height),s=l._drawLayer.entities.add(a)},t,a=new Cesium.Entity,l=this,s,c=1,r=new Cesium.ScreenSpaceEventHandler(this._viewer.scene.canvas);r.setInputAction(function(h){const o=d(l._viewer,h.position);o&&o.x&&(t?(i(t,o),r.destroy(),typeof e.callback=="function"&&e.callback({center:t,radius:c},s)):(t=o,n()))},Cesium.ScreenSpaceEventType.LEFT_CLICK),r.setInputAction(function(h){const o=l._viewer.scene.camera.pickEllipsoid(h.endPosition,l._viewer.scene.globe.ellipsoid);t&&o&&o.x&&i(t,o)},Cesium.ScreenSpaceEventType.MOUSE_MOVE)}}drawTrianglesGraphics(e){if(e=e||{},e.style=e.style||{width:3,material:Cesium.Color.BLUE.withAlpha(.5)},this._viewer&&e){let i=function(C,u){if(!C&&!u||Cesium.Cartesian3.equals(C,u))return 0;const m=Cesium.Cartographic.fromCartesian(C);return(Cesium.Cartographic.fromCartesian(u).height-m.height).toFixed(2)},n=function(C){const u=Cesium.Cartographic.fromCartesian(C[0]),m=Cesium.Cartographic.fromCartesian(C[1]);return Cesium.Cartesian3.fromDegrees(Cesium.Math.toDegrees(u.longitude),Cesium.Math.toDegrees(u.latitude),m.height)};const t=new Cesium.Entity,a=new Cesium.Entity,l=new Cesium.Entity,s=[],c=[],r=[],h=this,o=new Cesium.ScreenSpaceEventHandler(this._viewer.scene.canvas);o.setInputAction(function(C){const u=d(h._viewer,C.position);if(!u)return!1;s.length==0?(s.push(u.clone()),s.push(u.clone()),c.push(u.clone()),c.push(u.clone())):(o.destroy(),typeof e.callback=="function"&&e.callback({e:t,e2:a,e3:l}))},Cesium.ScreenSpaceEventType.LEFT_CLICK),o.setInputAction(function(C){const u=d(h._viewer,C.endPosition);if(u&&s.length>0){s.pop(),s.push(u.clone());const m=n(s);c.pop(),c.push(m.clone()),r.pop(),r.pop(),r.push(u.clone()),r.push(m.clone())}},Cesium.ScreenSpaceEventType.MOUSE_MOVE),t.polyline=y({positions:new Cesium.CallbackProperty(function(){return s},!1)},e.style),t.position=new Cesium.CallbackProperty(function(){return s[0]},!1),t.point={pixelSize:5,outlineColor:Cesium.Color.BLUE,outlineWidth:5},t.label={text:new Cesium.CallbackProperty(function(){return"直线:"+g(f(s))+"米"},!1),show:!0,showBackground:!0,font:"14px monospace",horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(50,-100)},a.polyline=y({positions:new Cesium.CallbackProperty(function(){return c},!1)},e.style),a.position=new Cesium.CallbackProperty(function(){return r[1]},!1),a.point={pixelSize:5,outlineColor:Cesium.Color.BLUE,outlineWidth:5},a.label={text:new Cesium.CallbackProperty(function(){return"高度:"+i(c[0],c[1])+"米"},!1),show:!0,showBackground:!0,font:"14px monospace",horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(-20,100)},l.polyline=y({positions:new Cesium.CallbackProperty(function(){return r},!1)},e.style),l.position=new Cesium.CallbackProperty(function(){return s[1]},!1),l.point={pixelSize:5,outlineColor:Cesium.Color.BLUE,outlineWidth:5},l.label={text:new Cesium.CallbackProperty(function(){return"水平距离:"+g(f(r))+"米"},!1),show:!0,showBackground:!0,font:"14px monospace",horizontalOrigin:Cesium.HorizontalOrigin.LEFT,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,pixelOffset:new Cesium.Cartesian2(-150,-20)},this._drawLayer.entities.add(l),this._drawLayer.entities.add(a),this._drawLayer.entities.add(t)}}drawWallGraphics(e){if(e=e||{},e.style=e.style||{material:Cesium.Color.BLUE.withAlpha(.5),outline:!0,outlineColor:Cesium.Color.WHITE},this._viewer&&e){const i=this;this.drawPolygonGraphics({callback:function(n,t){const a=i._drawLayer.entities.add({wall:y({positions:E(n)},e.style)});typeof e.callback=="function"&&e.callback(n,a)}})}}drawEllipsoidGraphics(e){if(e=e||{},e.style=e.style||{},this._viewer&&e){const i=this,n=new k(i._viewer);this.drawCircleGraphics({callback:function(t,a){console.log(t);const l=n.createGraphics();l.ellipsoid=n.getEllipsoidGraphics({}),l.position=t.center,i._drawLayer.entities.remove(a);const s=i._drawLayer.entities.add(l);typeof e.callback=="function"&&e.callback({center:t.center,radius:t.radius},s)}})}}drawCylinderGraphics(e){if(e=e||{},e.style=e.style||{},this._viewer&&e){const i=this;this.drawCircleGraphics({callback:function(n,t){const a=i._drawLayer.entities.add({position:n.center,cylinder:{length:n.radius*2||e.length,topRadius:e.topRadius||n.radius,bottomRadius:e.bottomRadius||n.radius,material:Cesium.Color.BLUE.withAlpha(.5),outline:!0,outlineColor:Cesium.Color.WHITE}});i._drawLayer.entities.remove(t),typeof e.callback=="function"&&e.callback({center:n.center,radius:n.radius},a)}})}}drawCorridorGraphics(e){if(e=e||{},e.style=e.style||{},this._viewer&&e){const i=this;i.drawLineGraphics({callback:function(n,t){const a=new Cesium.Entity;a.corridor={positions:E(n),height:e.height||1,width:e.width||100,cornerType:Cesium.CornerType.BEVELED,extrudedHeight:e.extrudedHeight||1,material:Cesium.Color.BLUE.withAlpha(.5),outline:!0,outlineColor:Cesium.Color.WHITE},i._drawLayer.entities.remove(t);const l=i._drawLayer.entities.add(a);typeof e.callback=="function"&&e.callback(n,l)}})}}drawPolylineVolumeGraphics(e){if(e=e||{},e.style=e.style||{},this._viewer&&e){const i=this;i.drawLineGraphics({callback:function(n,t){const a=new Cesium.Entity;a.polylineVolume={positions:E(n),shape:i.computeStar2d(7,150,300),cornerType:Cesium.CornerType.MITERED,material:Cesium.Color.BLUE},i._drawLayer.entities.remove(t);const l=i._drawLayer.entities.add(a);typeof e.callback=="function"&&e.callback(n,l)}})}}}export{I as C};
//# sourceMappingURL=index-DO19Fvpz.js.map
