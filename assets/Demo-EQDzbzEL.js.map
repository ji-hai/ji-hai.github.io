{"version":3,"file":"Demo-EQDzbzEL.js","sources":["../../src/views/Line/Demo.vue"],"sourcesContent":["<script setup lang=\"ts\">\r\nimport { ContentWrap } from '@/components/ContentWrap'\r\nimport CesiumComponent from '@/components/Cesium/Cesium.component.vue'\r\n\r\nimport { useCesium } from '@/hooks/web/useCesium'\r\nimport * as Cesium from 'cesium'\r\n\r\nimport {\r\n  WaveCircleMaterial,\r\n  PolylineTrailLinkMaterialProperty\r\n} from '@/components/Cesium/CesiumMaterialProperty'\r\n\r\nconst { mapRegister, mapMethods } = useCesium()\r\n\r\nconst { getMap } = mapMethods\r\n\r\nimport CesiumGraphics from '@/components/Cesium/CesiumGraphics'\r\n\r\ndefineOptions({\r\n  name: 'Demo'\r\n})\r\n\r\nlet entityModel\r\nconst cesiumLoadCB = (viewer) => {\r\n  const Graphics = new CesiumGraphics(viewer)\r\n  //  模型\r\n  let hpr = new Cesium.HeadingPitchRoll(\r\n    Cesium.Math.toRadians(0),\r\n    Cesium.Math.toRadians(0), //0朝下 180朝上\r\n    Cesium.Math.toRadians(0)\r\n  )\r\n  let r = Cesium.Math.toRadians(2)\r\n  let lon = 120.16907205003166,\r\n    lat = 30.175928962346774,\r\n    height = 0,\r\n    isUp = true\r\n  Graphics.createModelGraphics({\r\n    position: new Cesium.CallbackProperty((e) => {\r\n      // if (height > 400) {\r\n      //   height = 400\r\n      //   isUp = false\r\n      // } else if (height < 350) {\r\n      //   height = 350\r\n      //   isUp = true\r\n      // }\r\n      // if (isUp) {\r\n      //   height += 1.0\r\n      // } else {\r\n      //   height -= 1.0\r\n      // }\r\n\r\n      return Cesium.Cartesian3.fromDegrees(lon, lat, height)\r\n    }, false),\r\n    orientation: new Cesium.CallbackProperty((e) => {\r\n      hpr.heading += r\r\n\r\n      let position = Cesium.Cartesian3.fromDegrees(lon, lat, height)\r\n      return Cesium.Transforms.headingPitchRollQuaternion(position, hpr)\r\n    }, false),\r\n    model: {\r\n      uri: '/src/assets/SampleData/glb/pyramid.glb',\r\n      minimumPixelSize: 30,\r\n      // maximumScale: 200,\r\n      scale: 0.0001\r\n    }\r\n  })\r\n\r\n  viewer.entities.add({\r\n    name: 'ellipse',\r\n    position: Cesium.Cartesian3.fromDegrees(lon, lat, 5),\r\n    ellipse: {\r\n      semiMajorAxis: 30,\r\n      semiMinorAxis: 30,\r\n      material: WaveCircleMaterial({\r\n        duration: 2e3,\r\n\r\n        gradient: 0,\r\n\r\n        color: new Cesium.Color(1.0, 0.0, 0.0, 1.0),\r\n\r\n        count: 3\r\n      })\r\n    }\r\n  })\r\n\r\n  entityModel = new Cesium.Entity({\r\n    position: Cesium.Cartesian3.fromDegrees(120.16907205003166, 30.175928962346774, 0),\r\n    orientation: Cesium.Transforms.headingPitchRollQuaternion(\r\n      Cesium.Cartesian3.fromDegrees(120.16907205003166, 30.175928962346774, 0),\r\n      new Cesium.HeadingPitchRoll(\r\n        Cesium.Math.toRadians(90), // 方向\r\n        Cesium.Math.toRadians(0),\r\n        Cesium.Math.toRadians(0)\r\n      )\r\n    ),\r\n    heightReference: Cesium.HeightReference.CLAMP_TO_GROUND,\r\n    model: {\r\n      uri: '//data.mars3d.cn/gltf/mars/jingche/jingche.gltf',\r\n      minimumPixelSize: 30,\r\n      // maximumScale: 200,\r\n      scale: 0.001,\r\n      show: true\r\n      // 设置显示和隐藏的距离范围\r\n      // distanceDisplayCondition: new Cesium.DistanceDisplayCondition(0.0, 5000.0)\r\n    },\r\n    path: {\r\n      material: Cesium.Color.YELLOW,\r\n      leadTime: 0,\r\n      trailTime: 200,\r\n      width: 3\r\n    }\r\n  })\r\n\r\n  viewer.entities.add(entityModel)\r\n  viewer.flyTo(entityModel)\r\n  // viewer.trackedEntity = entityModel\r\n\r\n  animation(viewer)\r\n\r\n  viewer.entities.add({\r\n    polyline: {\r\n      positions: [\r\n        Cesium.Cartesian3.fromDegrees(120.19332557663305, 30.18517782709273, 0),\r\n        Cesium.Cartesian3.fromDegrees(120.18332557663305, 30.18537782709273, 0),\r\n        Cesium.Cartesian3.fromDegrees(120.17007205003166, 30.185928962346774, 0)\r\n      ],\r\n      width: 10,\r\n      material: new PolylineTrailLinkMaterialProperty(\r\n        3000,\r\n        new Cesium.Color(1, 36, 46),\r\n        new Cesium.Cartesian2(6.0, 1.0),\r\n        'src/assets/image/line5.png'\r\n      )\r\n    }\r\n  })\r\n}\r\n\r\nconst computeFlight = (start, source) => {\r\n  // 取样位置 相当于一个集合\r\n  let property = new Cesium.SampledPositionProperty()\r\n  for (let i = 0; i < source.length; i++) {\r\n    let time = Cesium.JulianDate.addSeconds(start, source[i].time, new Cesium.JulianDate())\r\n    let position = Cesium.Cartesian3.fromDegrees(\r\n      source[i].longitude,\r\n      source[i].latitude,\r\n      source[i].height\r\n    )\r\n    // 添加位置，和时间对应\r\n    property.addSample(time, position)\r\n  }\r\n  return property\r\n}\r\n\r\nconst animation = (viewer) => {\r\n  // 起始时间\r\n  let start = Cesium.JulianDate.fromDate(new Date())\r\n  // 结束时间\r\n  let stop = Cesium.JulianDate.addSeconds(start, 200, new Cesium.JulianDate())\r\n  // 设置始时钟始时间\r\n  viewer.clock.startTime = start.clone()\r\n  // 设置时钟当前时间\r\n  viewer.clock.currentTime = start.clone()\r\n  // 设置始终停止时间\r\n  viewer.clock.stopTime = stop.clone()\r\n  // 时间速率，数字越大时间过的越快\r\n  viewer.clock.multiplier = 10\r\n  // 时间轴\r\n  viewer.timeline.zoomTo(start, stop)\r\n  // 循环执行,即为2，到达终止时间，重新从起点时间开始\r\n  // CLAMPED：达到终止时间后停止\r\n  // LOOP_STOP：达到终止时间后重新循环\r\n  // UNBOUNDED：达到终止时间后继续读秒（默认）\r\n  viewer.clock.clockRange = Cesium.ClockRange.LOOP_STOP\r\n\r\n  let availability = new Cesium.TimeIntervalCollection([\r\n    new Cesium.TimeInterval({\r\n      start: start,\r\n      stop: stop\r\n    })\r\n  ])\r\n\r\n  let property = computeFlight(start, [\r\n    {\r\n      longitude: 120.16907205003166,\r\n      latitude: 30.175928962346774,\r\n      height: 0,\r\n      time: 0\r\n    },\r\n    {\r\n      longitude: 120.18232557663305,\r\n      latitude: 30.17537782709273,\r\n      height: 0,\r\n      time: 200\r\n    }\r\n  ])\r\n\r\n  entityModel.availability = availability\r\n  entityModel.position = property\r\n}\r\n</script>\r\n\r\n<template>\r\n  <ContentWrap title=\"Demo\">\r\n    <div class=\"w-[100%] h-[100%]\">\r\n      <cesium-component\r\n        @register=\"mapRegister\"\r\n        :config=\"{\r\n          // homeButton: true\r\n        }\"\r\n        tiandituTk=\"80cd3c8ae46ae32fa0ac19f6d739d310\"\r\n        :cesiumLoadCB=\"cesiumLoadCB\"\r\n      />\r\n    </div>\r\n  </ContentWrap>\r\n</template>\r\n"],"names":["mapRegister","mapMethods","useCesium","entityModel","cesiumLoadCB","viewer","Graphics","CesiumGraphics","hpr","r","lon","lat","height","e","position","WaveCircleMaterial","animation","PolylineTrailLinkMaterialProperty","computeFlight","start","source","property","i","time","stop","availability"],"mappings":"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"}